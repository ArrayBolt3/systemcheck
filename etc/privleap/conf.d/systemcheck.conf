## Copyright (C) 2012 - 2025 ENCRYPTED SUPPORT LLC <adrelanos@whonix.org>
## See the file COPYING for copying conditions.

## Apt
[apt-get-update]
Command=TMP=/tmp /usr/libexec/security-misc/apt-get-update
AuthorizedGroup=sudo

[apt-get-update-kill-helper]
Command=/usr/libexec/helper-scripts/apt-get-update-kill-helper
AuthorizedGroup=sudo

[apt-get-update-simulate]
Command=/usr/libexec/helper-scripts/apt-get-update-simulate
AuthorizedGroup=sudo

[apt-check-lock-files]
Command=/bin/fuser /var/lib/dpkg/lock /var/cache/apt/archives/lock
AuthorizedGroup=sudo

## Tor
[tor-verify-config]
Command=/usr/bin/tor --verify-config
AuthorizedGroup=sudo
TargetUser=debian-tor
TargetGroup=debian-tor

[tor-bootstrap-check]
Command=/usr/libexec/helper-scripts/tor_bootstrap_check.py
TargetUser=debian-tor
TargetGroup=debian-tor

[tor-circuit-established-check]
Command=/usr/bin/tor-circuit-established-check
TargetUser=debian-tor
TargetGroup=debian-tor

[tor-consensus-valid-after]
Command=/usr/libexec/helper-scripts/tor_consensus_valid-after.py
TargetUser=debian-tor
TargetGroup=debian-tor

[tor-consensus-valid-until]
Command=/usr/libexec/helper-scripts/tor_consensus_valid-until.py
TargetUser=debian-tor
TargetGroup=debian-tor

[onion-grater-status]
Command=/usr/bin/systemctl --no-pager --no-block status onion-grater
AuthorizedGroup=sudo

[whonix-firewall-status]
Command=/bin/systemctl --no-pager --no-block status whonix-firewall
AuthorizedGroup=sudo

[tor-status]
Command=/bin/systemctl --no-pager --no-block status tor
AuthorizedGroup=sudo

[tor-at-default-status]
Command=/bin/systemctl --no-pager --no-block status tor@default
AuthorizedGroup=sudo

[check-tor-running]
Command=/usr/libexec/systemcheck/check_tor_running
AuthorizedGroup=sudo

## Sdwdate
[onion-time-pre-script]
Command=/usr/libexec/helper-scripts/onion-time-pre-script
AuthorizedGroup=sudo
TargetUser=sdwdate
TargetGroup=sdwdate

## Qubes
[qubes-updates-proxy-status]
Command=/usr/bin/systemctl --no-pager --no-block status qubes-updates-proxy.service
AuthorizedGroup=sudo

## anondate
[anondate-verified-only-has-consensus]
Command=/usr/sbin/anondate --verified-only --has-consensus
AuthorizedGroup=sudo

[anondate-unverified-only-has-consensus]
Command=/usr/sbin/anondate --unverified-only --has-consensus
AuthorizedGroup=sudo

[anondate-verified-only-current-time-in-valid-range]
Command=/usr/sbin/anondate --verified-only --current-time-in-valid-range
AuthorizedGroup=sudo

[anondate-unverified-only-current-time-in-valid-range]
Command=/usr/sbin/anondate --unverified-only --current-time-in-valid-range
AuthorizedGroup=sudo

[anondate-verified-only-show-valid-after]
Command=/usr/sbin/anondate --verified-only --show-valid-after
AuthorizedGroup=sudo

[anondate-unverified-only-show-valid-after]
Command=/usr/sbin/anondate --unverified-only --show-valid-after
AuthorizedGroup=sudo

[anondate-verified-only-show-valid-until]
Command=/usr/sbin/anondate --verified-only --show-valid-until
AuthorizedGroup=sudo

[anondate-unverified-only-show-valid-until]
Command=/usr/sbin/anondate --unverified-only --show-valid-until
AuthorizedGroup=sudo

[anondate-verified-only-show-middle-range]
Command=/usr/sbin/anondate --verified-only --show-middle-range
AuthorizedGroup=sudo

[anondate-unverified-only-show-middle-range]
Command=/usr/sbin/anondate --unverified-only --show-middle-range
AuthorizedGroup=sudo

[anondate-verified-only-user-permission]
Command=/usr/sbin/anondate --verified-only --user-permission
AuthorizedGroup=sudo

[anondate-unverified-only-user-permission]
Command=/usr/sbin/anondate --unverified-only --user-permission
AuthorizedGroup=sudo

[anondate-verified-only-group-permission]
Command=/usr/sbin/anondate --verified-only --group-permission
AuthorizedGroup=sudo

[anondate-unverified-only-group-permission]
Command=/usr/sbin/anondate --unverified-only --group-permission
AuthorizedGroup=sudo

[anondate-tor-cert-lifetime-valid]
Command=/usr/sbin/anondate --tor-cert-lifetime-valid
AuthorizedGroup=sudo

[anondate-tor-cert-valid-after]
Command=/usr/sbin/anondate --tor-cert-valid-after
AuthorizedGroup=sudo

## Networking
[ifconfig-eth0-info]
Command=/sbin/ifconfig eth0
AuthorizedGroup=sudo

[ifconfig-eth1-info]
Command=/sbin/ifconfig eth1
AuthorizedGroup=sudo

[eth0-carrier]
Command=/bin/cat /sys/class/net/eth0/carrier
AuthorizedGroup=sudo

[eth1-carrier]
Command=/bin/cat /sys/class/net/eth1/carrier
AuthorizedGroup=sudo

## System logs
[read-dmesg-logs]
Command=/usr/bin/dmesg
AuthorizedGroup=sudo

[read-journalctl-logs]
Command=/usr/bin/journalctl --boot --no-pager
AuthorizedGroup=sudo

[read-journalctl-logs-brief]
Command=/usr/bin/journalctl --boot --no-pager --priority=0..4
AuthorizedGroup=sudo

[read-journalctl-logs-whonix-firewall]
Command=/usr/bin/journalctl --boot --no-pager -u whonix-firewall
AuthorizedGroup=sudo

[read-systemctl-logs-failed-units]
Command=/bin/systemctl --no-pager --no-block --no-legend --failed
AuthorizedGroup=sudo

[read-systemctl-logs-failed-units-pretty]
Command=/bin/systemctl --no-pager --no-block --failed list-units
AuthorizedGroup=sudo

[read-apparmor-info]
Command=/usr/sbin/apparmor-info --boot
AuthorizedGroup=sudo

## Vuln checks
[spectre-meltdown-checker]
Command=/usr/bin/spectre-meltdown-checker --paranoid
AuthorizedGroup=sudo

## Warrant canary
[check-warrant-canary]
Command=/bin/systemctl --no-pager --no-block status canary
AuthorizedGroup=sudo

## Clocksource
[sys-current-clocksource]
Command=/bin/cat /sys/devices/system/clocksource/clocksource0/current_clocksource
AuthorizedGroup=sudo

[sys-available-clocksource]
Command=/bin/cat /sys/devices/system/clocksource/clocksource0/available_clocksource
AuthorizedGroup=sudo

## Virtualization detection
[systemd-detect-virt]
Command=/usr/bin/systemd-detect-virt
AuthorizedGroup=sudo

## Checking that privleap works
[check-privleap]
Command=/usr/bin/test -x /usr/bin/test

## Persistent user config
[persistent-users]
User=sdwdate